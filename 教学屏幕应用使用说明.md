# 教学屏幕应用使用说明

## 📋 系统概述

教学屏幕应用是一个基于Web的智能教学管理系统，专为实验室和教学环境设计。系统包含管理端和大屏显示端，支持项目管理、实验室管理、课表管理、公告发布等功能，并提供实时的大屏展示功能。

### 🎯 主要功能模块
- **项目管理**：支持项目信息的增删改查，支持批量导入，支持论文和视频文件管理
- **班级管理**：管理班级信息，包括班级名称、专业和人数，用于课表自动计算报课人数
- **实验室管理**：配置实验室信息和时间安排
- **课表管理**：设置课程时间表和特殊安排，支持使用班级名称自动计算报课人数
- **横幅管理**：发布和管理顶部横幅公告，支持居中显示和滚动动画
- **大屏展示**：实时显示当前课程和项目信息，支持论文和视频查看
- **数据导出**：支持Excel格式的数据导出
- **智能启动**：自动搜索局域网内的服务器

---

## 🚀 系统启动

### 方式一：开发模式启动（推荐开发者）
1. 确保已安装 Node.js 16+ 版本
2. 双击运行 `start-dev.bat`
3. 系统将自动安装依赖并启动所有服务

### 方式二：安装版启动（推荐用户）
1. 以管理员身份运行 `install.bat`
2. 双击桌面快捷方式启动
3. 通过浏览器访问管理端和大屏端

### 方式三：便携版启动（推荐临时使用）
1. 运行 `build.bat` 构建应用
2. 运行 `start-dev.bat` 启动
3. 将整个文件夹复制到目标机器即可使用

### 🌐 访问地址
- **管理端**: http://localhost:3000/admin
- **大屏端**: http://localhost:3000/screen
- **API接口**: http://localhost:3000/api
- **健康检查**: http://localhost:3000/health

---

## 📚 详细使用说明

### 第一部分：系统初始化配置

#### 1.1 全局管理 - 系统基础配置

**访问路径**: 管理端 → 全局管理

**主要功能**:
- 横幅公告管理
- 夏令时区间设置
- 开学日期配置
- 大屏显示设置
- 实验室容量设置
- 数据管理

**操作步骤**:

##### 1.1.1 横幅公告设置
1. 在"横幅公告"区域输入公告内容
2. 选择公告级别：普通/提醒/紧急
3. 开启"滚动显示"开关（可选）
4. 设置滚动时间（5-60秒，默认15秒）
5. 可选设置到期时间
6. 点击"保存横幅"按钮
7. 系统自动刷新大屏显示

**横幅管理功能**:
- **保存横幅**: 设置横幅内容、级别、滚动效果和到期时间
- **取消横幅**: 一键取消横幅显示，清空所有设置，横幅立即从大屏消失
- **设置测试横幅**: 快速设置测试内容用于验证功能

**滚动显示功能**:
- **开启滚动**: 勾选"滚动显示"开关启用滚动动画
- **滚动时间**: 设置滚动速度（5-60秒），滚动时间等于设置时间
- **滚动效果**: 文字从屏幕右侧滚动到左侧边缘，横跨整个屏幕宽度
- **静态显示**: 不开启滚动时，文字居中显示

**注意事项**:
- 横幅内容支持多行文本和滚动显示
- 滚动横幅横跨整个屏幕宽度，从最右侧到最左侧
- 横幅级别影响显示颜色（普通-蓝色，提醒-黄色，紧急-红色）
- 到期时间不设置则永久显示
- 保存后会自动更新大屏显示
- 取消横幅后如需重新显示，需要重新设置内容

##### 1.1.2 夏令时区间配置
1. 设置夏令时开始日期
2. 设置夏令时结束日期
3. 点击"保存"按钮
4. 默认设置为5月1日-10月7日

##### 1.1.3 开学日期设置
1. 选择开学日期（第1周的周一）
2. 点击"保存"按钮
3. 用于计算学期周号（默认16周）

##### 1.1.4 大屏显示设置
**显示模式选择**:
- **自适应模式**: 根据屏幕尺寸自动调整布局
- **固定模式**: 按照指定尺寸显示

**固定模式配置**（当选择固定模式时）:
- 宽度：800-3840像素
- 高度：600-2160像素
- 缩放：50%-200%

##### 1.1.5 实验室容量设置
1. 查看所有实验室列表
2. 修改每个实验室的容量数值
3. 点击对应实验室的"保存"按钮
4. 容量影响课表显示和补课功能

##### 1.1.6 数据管理
**清空所有数据**:
- 删除所有课表数据、项目数据、横幅数据、班级数据
- 保留实验室配置和系统设置
- 操作不可恢复

**删除课表数据**:
- 可选择删除单个教室或所有教室的课表数据
- 支持按教室名称选择
- 操作不可恢复

**删除项目数据**:
- 可选择删除当前年份或所有年份的训练营项目数据
- 删除项目时会同时删除相关的视频文件
- 支持按年份选择
- 下拉菜单中还包含"删除所有班级"选项
- 操作不可恢复

---

### 第二部分：项目管理

#### 2.1 项目管理 - 训练营项目

**访问路径**: 管理端 → 项目管理

**主要功能**:
- 项目列表管理
- 项目信息编辑
- 批量上传项目
- 数据导出
- 文件管理

**操作步骤**:

##### 2.1.1 项目列表管理
1. **查看项目列表**:
   - 按年份筛选：选择特定年份或"全部"
   - 搜索功能：按项目标题或导师姓名搜索
   - 状态显示：审核中/进行中/已完成

2. **新增项目**:
   - 点击"新增项目"按钮
   - 填写项目基本信息：
     - 项目标题（必填）
     - 导师（必填）
     - 人数（必填）
     - 状态：审核中/进行中/已完成
     - 年份（必填）
     - 项目简介
   - 设置团队成员：
     - 第一个成员为队长（显示👑图标）
     - 可添加多个成员
     - 成员数量不能超过项目人数
   - 设置是否为优秀项目
   - 点击"保存"按钮

3. **编辑项目**:
   - 点击项目列表中的"编辑"按钮
   - 修改项目信息
   - 点击"保存"按钮

4. **删除项目**:
   - 点击"删除"按钮
   - 确认删除操作
   - 系统会删除项目及其相关文件

5. **设为优秀项目**:
   - 点击"设为优秀"按钮
   - 优秀项目会在大屏上轮播显示

##### 2.1.2 文件管理
**封面图片上传**:
1. 先保存项目基本信息
2. 在项目编辑页面点击"上传图片"
3. 选择图片文件（支持常见图片格式）
4. 系统自动上传并显示预览
5. 可点击"删除图片"移除封面

**论文文件上传**:
1. 先保存项目基本信息
2. 点击"上传论文"按钮
3. 选择PDF文件（仅支持PDF格式）
4. 系统自动上传并显示文件名
5. 可点击"删除论文"移除文件

**演示视频上传**:
1. 先保存项目基本信息
2. 点击"上传视频"按钮
3. 选择视频文件（支持MP4、WebM、OGG、MOV格式，建议使用H.264编码）
4. 系统自动命名为"项目名称演示视频.扩展名"
5. 可点击"删除视频"移除文件
6. **注意**：视频文件大小不能超过100MB，建议使用H.264编码以确保浏览器兼容性

##### 2.1.3 批量上传项目
1. 切换到"批量上传"标签页
2. 准备Excel或CSV文件
3. 文件格式要求：
   - 支持Excel(.xlsx/.xls)和CSV(.csv)格式
   - CSV文件需使用UTF-8编码
   - 字段用逗号分隔
   - 必需字段：项目标题、导师、人数、状态、年份
   - 可选字段：简介、团队成员、优秀、论文文件名
4. 点击"选择文件"上传
5. 系统自动解析并显示预览
6. 确认无误后点击"确认上传"
7. 系统批量创建项目

**批量上传字段说明**:
- 项目标题：项目名称
- 导师：指导教师姓名
- 人数：项目参与人数
- 状态：审核中/进行中/已完成
- 年份：项目所属年份
- 优秀：是/否
- 简介：项目描述
- 团队成员：用逗号分隔的成员姓名，第一个为队长
- 论文文件名：论文文件名称

##### 2.1.4 数据导出
1. 点击"导出数据"下拉菜单
2. 选择导出类型：
   - 本学期：当前学期的所有项目
   - 所有学期：所有年份的项目
   - 本学期优秀：当前学期的优秀项目
   - 所有学期优秀：所有年份的优秀项目
3. 系统自动生成Excel文件并下载

---

### 第二部分补充：班级管理

#### 2.2 班级管理 - 班级信息

**访问路径**: 管理端 → 班级管理

**主要功能**:
- 班级列表管理
- 班级信息编辑
- 批量上传班级
- 班级数据导出

**操作步骤**:

##### 2.2.1 班级列表管理
1. **查看班级列表**:
   - 显示所有班级的基本信息
   - 包括班级名称、专业、人数
   - 支持按专业筛选和搜索

2. **新增班级**:
   - 点击"新增班级"按钮
   - 填写班级信息：
     - 班级名称（必填）：如"计算机1班"
     - 专业（可选）：如"计算机科学与技术"
     - 人数（必填）：班级学生总数
   - 点击"保存"按钮

3. **编辑班级**:
   - 点击班级列表中的"编辑"按钮
   - 修改班级信息
   - 点击"保存"按钮

4. **删除班级**:
   - 点击"删除"按钮
   - 确认删除操作
   - **注意**：删除班级可能影响课表中使用该班级的课程

##### 2.2.2 批量上传班级
1. 切换到"批量上传"标签页
2. 准备Excel或CSV文件
3. 文件格式要求：
   - 支持Excel(.xlsx/.xls)和CSV(.csv)格式
   - 必需字段：班级名称、人数
   - 可选字段：专业
4. 点击"选择文件"上传
5. 系统自动解析并显示预览
6. 确认无误后点击"确认上传"
7. 系统批量创建班级

**批量上传字段说明**:
- 班级名称：班级名称，如"计算机1班"（必填，唯一）
- 专业：专业名称，如"计算机科学与技术"（可选）
- 人数：班级学生总数（必填）

##### 2.2.3 班级在课表中的使用
- 在课表管理中，可以填写"班级名称"字段
- 支持多个班级，用逗号或顿号分隔，如"计算机1班,计算机2班"
- 系统会自动计算所有班级的总人数作为报课人数
- 如果班级不存在，系统会提示错误

---

### 第三部分：课表管理

#### 3.1 课表管理 - 课程安排

**访问路径**: 管理端 → 课表管理

**主要功能**:
- 课表网格管理
- 课程信息编辑
- 批量上传课表
- 课表数据导出
- 多课时课程管理

**操作步骤**:

##### 3.1.1 课表网格管理
1. **选择教室和周次**:
   - 在顶部选择要管理的教室
   - 选择周次（使用周选择器）
   - 系统显示该周该教室的课表

2. **查看课表信息**:
   - 网格显示：星期×节次的课程安排
   - 课程信息：课程名称、教师、内容、报课人数、课时
   - 容量显示：显示教室容量和是否可补课

3. **添加课程**:
   - 点击空白时间格子
   - 填写课程信息：
     - 星期：选择星期几
     - 节次：选择第几节课
     - 课程：课程名称
     - 教师：授课教师
     - 内容：课程内容描述
     - 报课人数：已报名人数（可选，如果填写了班级名称则自动计算）
     - 班级名称：填写上课班级，如"计算机1班,计算机2班"或"计算机1班、计算机2班"（支持逗号或顿号分隔）
     - 课时：课程持续节数（1-8节）
   - 点击"添加"按钮
   - **注意**：如果同时填写了报课人数和班级名称，系统优先使用报课人数；如果只填写班级名称，系统会自动计算所有班级的总人数

4. **编辑课程**:
   - 点击已有课程格子
   - 修改课程信息
   - 支持修改时间、内容等
   - 点击"保存"按钮

5. **删除课程**:
   - 在编辑模式下点击"删除"按钮
   - 确认删除操作
   - 系统会删除整个课时（所有相关节次）

##### 3.1.2 多课时课程管理
**多课时课程特点**:
- 一个课程可以跨越多个节次
- 系统自动处理多课时的显示和编辑
- 修改时间会重新安排整个课程

**多课时操作**:
1. **创建多课时课程**:
   - 设置课时数（如3课时）
   - 系统自动占用连续节次
   - 显示为跨多个格子的课程

2. **编辑多课时课程**:
   - 点击课程任意节次进入编辑
   - 修改信息会同步到所有节次
   - 修改时间会重新安排整个课程

3. **删除多课时课程**:
   - 删除操作会删除整个课程的所有节次
   - 系统自动清理相关数据

##### 3.1.3 批量上传课表
1. 切换到"批量上传"标签页
2. 准备Excel或CSV文件
3. 文件格式要求：
   - 支持Excel(.xlsx/.xls)和CSV(.csv)格式
   - 必需字段：日期、节次、课程、教师、报课人数、课时
   - 可选字段：内容、教室
4. 上传文件并预览数据
5. 系统进行预检，显示错误信息
6. 确认无误后点击"确认上传"
7. 系统批量创建或更新课程

**批量上传字段说明**:
- 日期：上课日期（YYYY-MM-DD格式）
- 节次：第几节课（1-8）
- 课程：课程名称
- 教师：授课教师姓名
- 内容：课程内容描述
- 报课人数：已报名人数
- 课时：课程持续节数
- 教室：教室名称（可选，不填则使用当前选中教室）

##### 3.1.4 课表数据导出
1. 点击"导出课表"按钮
2. 系统自动收集所有教室的课表数据
3. 生成包含多个工作表的Excel文件
4. 每个教室一个工作表
5. 包含整个学期的课程安排

---

### 第四部分：可视化控制

#### 4.1 可视化控制 - 大屏展示配置

**访问路径**: 管理端 → 可视化控制

**主要功能**:
- KPI指标配置
- 中间部分展示配置
- 图表类型选择
- 大屏刷新控制

**操作步骤**:

##### 4.1.1 KPI指标配置
1. **选择KPI指标**:
   - 从可用指标中选择3个显示在大屏顶部
   - 可选指标包括：
     - 课程总数：当前学期的课程总数
     - 已上课时数：截止目前已上的课时数
     - 出勤人数：当前出勤人数
     - 使用率：实验室使用率百分比
     - 项目总数：训练营项目总数
     - 参与人数：项目参与人数
     - 实验室数量：可用实验室总数
     - 活跃实验室：当前活跃的实验室数量
     - 完成率：项目完成率百分比
     - 学期总预计出勤：本学期总的预计出勤人数
     - 学期总课时数：本学期总课时数
     - 学期总课程数：本学期总课程数

2. **保存KPI配置**:
   - 必须选择3个指标
   - 点击"保存配置"按钮
   - 系统自动更新大屏显示

##### 4.1.2 中间部分展示配置
**显示模式选择**:
- **大图表模式**: 中间部分显示一个大的可视化图表
- **四小图表模式**: 中间部分显示四个小图表

**大图表模式配置**:
1. 选择图表类型：
   - 实验室使用热力图：按星期和时段展示实验室使用密度分布
   - 项目状态分布（饼图）：各项目状态占比分布情况
   - 实验室使用率对比（柱状图）：各实验室使用率对比分析
   - 时间趋势（折线图）：最近6周实验人次变化趋势
   - 热门项目（排行榜）：按参与人数排序的项目排行
   - 课容量利用率（仪表盘）：总报课人数与总可容纳人数比率
   - 教师工作量分析（柱状图）：各教师授课课时统计分析

**四小图表模式配置**:
1. 为每个图表选择类型
2. 设置图表标题
3. 系统自动填充默认标题
4. 支持自定义标题

##### 4.1.3 大屏刷新控制
1. **保存配置**: 点击"保存配置"按钮保存所有设置
2. **刷新大屏**: 点击"刷新大屏"按钮立即更新大屏显示
3. **重新加载**: 点击"重新加载"按钮重新获取配置

---

### 第五部分：大屏显示

#### 5.1 大屏显示 - 实时展示

**访问路径**: http://localhost:3000/screen

**主要功能**:
- 实时数据展示
- 响应式布局
- 自动刷新
- 全屏模式

**界面布局**:

##### 5.1.1 顶部横幅
- 显示系统公告，支持静态居中显示和滚动动画
- 支持不同级别：普通（蓝色）/提醒（黄色）/紧急（红色）
- **滚动模式**：文字从屏幕右侧滚动到左侧边缘，横跨整个屏幕宽度
- **静态模式**：文字居中显示，适合短文本
- **滚动控制**：滚动时间可在管理端设置（5-60秒），滚动时间等于设置时间
- 自动到期隐藏
- 完全由管理端控制，用户无法关闭

##### 5.1.2 左侧：实验室卡片
- 显示各实验室当前状态
- 实时更新课程信息
- 显示实验室使用情况

##### 5.1.3 中间：KPI指标和图表
**KPI指标区域**:
- 显示3个关键指标
- 实时数据更新
- 数值和趋势显示

**图表区域**:
- 根据配置显示不同图表
- 支持热力图、饼图、柱状图等
- 交互式数据展示

**优秀项目轮播**:
- 自动轮播优秀项目
- 显示项目封面和基本信息
- 支持论文和演示视频查看
- 可在论文和视频之间切换显示
- 视频支持播放、暂停、进度控制和音量调节

##### 5.1.4 右侧：项目列表和统计
**项目列表**:
- 显示当前项目列表
- 按状态分类显示
- 实时更新项目信息

**项目统计**:
- 显示历年项目统计
- 图表化展示数据趋势

##### 5.1.5 大屏操作
**全屏模式**:
- 启动时自动进入全屏
- 按F11可切换全屏模式
- 支持不同屏幕尺寸

**自动刷新**:
- 每5秒自动检查数据更新
- 检测到更新时自动刷新
- 无需手动操作

**响应式布局**:
- 自适应不同屏幕尺寸
- 支持固定模式和自适应模式
- 确保最佳显示效果

---

## 🔧 高级功能

### 6.1 智能启动器

#### 6.1.1 智能前端启动器
**功能**: 自动搜索局域网内的服务器并启动大屏
**使用方法**:
1. 双击运行 `智能前端启动器.bat`
2. 系统自动搜索局域网内的服务器
3. 找到服务器后自动打开大屏页面
4. 支持Chrome/Edge浏览器

#### 6.1.2 前端展示页启动器
**功能**: 手动输入IP启动大屏
**使用方法**:
1. 双击运行 `前端展示页启动器.bat`
2. 输入服务器IP地址
3. 选择浏览器类型
4. 自动打开大屏页面

#### 6.1.3 快捷启动器
**功能**: 快速启动管理端
**使用方法**:
1. 双击运行 `快捷启动器.bat`
2. 自动打开管理端页面
3. 支持默认浏览器

### 6.2 数据备份与恢复

#### 6.2.1 数据备份
**备份内容**:
- 数据库文件：`data/app.db`
- 上传文件：`data/uploads/`
- 配置文件：系统设置

**备份方法**:
1. 停止所有服务
2. 复制 `data` 目录
3. 保存到安全位置

#### 6.2.2 数据恢复
**恢复方法**:
1. 停止所有服务
2. 替换 `data` 目录
3. 重启服务

### 6.3 系统维护

#### 6.3.1 日志查看
**后端日志**: 控制台输出
**前端日志**: 浏览器开发者工具 (F12)
**错误信息**: 查看控制台错误信息

#### 6.3.2 性能优化
- 定期清理上传文件
- 优化图片大小
- 使用SSD存储
- 确保充足内存

---

## 🐛 故障排除

### 7.1 常见问题

#### 7.1.1 端口被占用
**问题**: 启动时提示端口3000被占用
**解决方案**:
```bash
# 查看端口占用情况
netstat -an | findstr :3000

# 停止占用进程
taskkill /F /IM node.exe
```

#### 7.1.2 Node.js未安装或版本过低
**问题**: 提示Node.js未安装或版本过低
**解决方案**:
- 下载安装：https://nodejs.org/
- 选择LTS版本（推荐18.x）
- 安装后重启命令行

#### 7.1.3 权限不足
**问题**: 无法写入文件或创建目录
**解决方案**:
- 右键选择"以管理员身份运行"
- 确保有写入权限
- 检查文件夹权限设置

#### 7.1.4 网络连接问题
**问题**: 无法访问管理端或大屏端
**解决方案**:
- 检查防火墙设置
- 确保端口3000未被阻止
- 检查局域网连接
- 尝试使用localhost访问

#### 7.1.5 数据库问题
**问题**: 数据无法保存或读取
**解决方案**:
- 检查 `data/app.db` 文件是否存在
- 确保有读写权限
- 必要时重新初始化数据库

#### 7.1.6 大屏显示异常
**问题**: 大屏显示空白或布局错乱
**解决方案**:
- 检查浏览器兼容性（推荐Chrome/Edge）
- 清除浏览器缓存
- 检查网络连接
- 尝试刷新页面

### 7.2 数据恢复

#### 7.2.1 数据丢失恢复
**步骤**:
1. 停止所有服务
2. 检查 `data` 目录是否完整
3. 如有备份，恢复备份数据
4. 重启服务

#### 7.2.2 重新初始化
**步骤**:
1. 备份重要数据
2. 删除 `data` 目录
3. 重启服务
4. 重新配置系统

---

## 📋 附录

### 8.1 快捷键
- **F11**: 浏览器全屏模式
- **Ctrl+R**: 刷新页面
- **Ctrl+Shift+R**: 强制刷新
- **F12**: 打开开发者工具

### 8.2 配置文件
- **数据库配置**: `backend/src/app.module.ts`
- **端口配置**: `backend/src/main.ts`
- **前端配置**: `admin-frontend/vite.config.ts`

### 8.3 系统要求
**最低要求**:
- 操作系统: Windows 10/11 (64位)
- Node.js: 16.0+ (推荐LTS版本)
- 内存: 2GB RAM
- 磁盘空间: 500MB可用空间
- 网络: 支持局域网访问

**推荐配置**:
- 操作系统: Windows 11
- Node.js: 18.x LTS
- 内存: 4GB+ RAM
- 磁盘空间: 1GB+ 可用空间
- 浏览器: Chrome 90+ 或 Edge 90+

---

## ❓ 常见问题解答

### 横幅管理相关问题

**Q: 如何取消横幅显示？**
A: 在管理端的"全局设置"页面，找到"横幅公告"区域，点击红色的"取消横幅"按钮即可。取消后横幅会立即从大屏消失，表单也会被清空。

**Q: 取消横幅后如何重新显示？**
A: 取消横幅后，需要重新填写横幅内容，选择级别和显示状态，然后点击"保存横幅"按钮。

**Q: 横幅内容太长怎么办？**
A: 系统支持滚动动画显示长文本。在管理端开启"滚动显示"开关，设置合适的滚动时间（5-60秒），文字会从屏幕右侧滚动到左侧，横跨整个屏幕宽度。

**Q: 如何设置横幅滚动速度？**
A: 在管理端的横幅设置中，开启"滚动显示"后，可以设置"滚动时间"（5-60秒）。滚动时间等于设置时间，设置15秒就滚动15秒。

**Q: 横幅滚动范围有多大？**
A: 滚动横幅会横跨整个屏幕宽度，从屏幕最右侧滚动到左侧边缘，确保所有内容都能完整显示。

**Q: 横幅级别有什么区别？**
A: 
- **普通**：蓝色背景，用于一般信息
- **提醒**：黄色背景，用于重要提醒
- **紧急**：红色背景，用于紧急通知

**Q: 为什么点击"取消横幅"会失败？**
A: 这个问题已在最新版本中修复。如果仍然遇到问题，请检查网络连接或重新启动服务。

**Q: 横幅可以设置永久显示吗？**
A: 可以。在设置到期时间时，不选择任何时间，横幅就会永久显示，直到手动取消。

---

**最后更新**: 2024年12月
**版本**: 1.0.0
**维护者**: 开发团队
